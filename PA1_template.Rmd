---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

First read the csv and load it to the activity variable using read.csv(). 

```{r}
activity <- read.csv("activity.csv")
str(activity)
```

Then by looking at the data types of the activity variable's columns we find that the date column is character, so we transform it to date format.

```{r}
activity$date <- as.Date(activity$date)
str(activity)
```

## What is mean total number of steps taken per day?

1. Make a histogram of the total number of steps taken each day

```{r barplot, fig.height=5}
par(mar = c(6,6,2,2))
barplot(tapply(activity$steps, activity$date, sum, na.rm = TRUE), las = 2, col = "light blue", main = "Total number of steps / Day", cex.names = 0.6)
title(xlab = "Date", line = 4)
title(ylab = "Number of Steps", line = 4)
```

2. Calculate and report the mean and median total number of steps taken per day.

```{r}
## Mean
mean1 <- as.data.frame(tapply(activity$steps, activity$date, mean, na.rm = TRUE))
names(mean1)[1] <- "Mean"
mean1

## Median
median <- as.data.frame(tapply(activity$steps, activity$date, median, na.rm = TRUE))
names(median)[1] <- "Median"
median
```

## What is the average daily activity pattern?

1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r Time Series}
library(ggplot2)
ggplot(activity, aes(interval, steps)) + stat_summary(fun = mean, geom = "line", na.rm = TRUE) + labs(y = "Average Steps", x = "Intervals", title = "The Average Number of Steps Taken Across All Days")
```

2. Which 5-minute interval, on average across all the days in the dataset,
contains the maximum number of steps?

```{r}
intervals <- as.data.frame(tapply(activity$steps, activity$interval, mean, na.rm = TRUE))
rownames(intervals)[apply(intervals,2,which.max)]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
